#!/bin/bash
set -eu

# shellcheck disable=SC1091
. /etc/environment

export GOROOT=/usr/lib/go-1.13
export PATH="${GOROOT}/bin:$PATH"
export GO111MODULE=on

export GOPATH=$HOME/.gotools-install
export GO_BIN=$GOPATH/bin
export PATH="$GO_BIN:$PATH:$HOME/bin"

mkdir -p "$GOPATH"

cd "$GOPATH"

# shellcheck disable=SC2016
echo -e 'export GOPATH=$(pwd)\nexport GO111MODULE=on\n' > "$GOPATH/.envrc"
echo -e '*\n!.envrc\n!.versions' > "$GOPATH/.gitignore"

cat <<- END |xargs -n1 -IX go get -v X@latest
github.com/golangci/golangci-lint/cmd/golangci-lint
github.com/rogpeppe/godef
github.com/lukehoban/go-outline
sourcegraph.com/sqs/goreturns
github.com/tpng/gopkgs
github.com/newhook/go-symbols
github.com/ddollar/forego
github.com/github/hub
github.com/jstemmer/gotags
github.com/fatih/motion
github.com/zmb3/gogetdoc
github.com/josharian/impl
golang.org/x/lint/golint
golang.org/x/tools/gopls
github.com/ericchiang/pup
github.com/fatih/gomodifytags
github.com/klauspost/asmfmt/cmd/asmfmt
github.com/davidrjenni/reftools/cmd/fillstruct
github.com/junegunn/fzf
github.com/hoskeri/liverebuild
github.com/vmware/govmomi/govc
github.com/cosmos72/gomacro
cuelang.org/go/cmd/cue
END

# install gore in non-module mode.
GO111MODULE=off go get -u github.com/motemen/gore/cmd/gore
